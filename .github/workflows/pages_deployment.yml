name: ğŸš€ Despliegue de GitHub Pages y NotificaciÃ³n a Discord

# 1. Definir los eventos que disparan este workflow
on:
  push:
    branches:
      - main # Dispara el workflow cuando se haga push a la rama 'main'

  # Permite ejecutar este workflow manualmente desde la pestaÃ±a Actions
  workflow_dispatch:

# 2. Definir los trabajos (jobs)
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    
    # Define los permisos necesarios para el despliegue de Pages
    permissions:
      contents: read
      pages: write
      id-token: write

    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}

    steps:
      - name: â¬‡ï¸ Checkout del CÃ³digo
        uses: actions/checkout@v4

      - name: ğŸ› ï¸ Configurar PÃ¡ginas de GitHub
        uses: actions/configure-pages@v5

      # Si usas un generador estÃ¡tico (como Jekyll, Hugo, etc.), aquÃ­ irÃ­a tu paso de build.
      # Si solo son archivos estÃ¡ticos (HTML/CSS/JS), este paso no es necesario.
      # Ejemplo:
      # - name: ğŸ—ï¸ Compilar Sitio
      #   run: npm run build 

      - name: ğŸ“¦ Subir Artefacto
        uses: actions/upload-pages-artifact@v3
        with:
          # Directorio donde estÃ¡n tus archivos de sitio final
          path: '.' 

      - name: ğŸš€ Desplegar a GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

      # 3. Paso de NotificaciÃ³n a Discord (Usando sarisia/actions-status-discord)
      - name: ğŸ”” Notificar a Discord sobre el Estado de la CompilaciÃ³n
        if: always() 
        uses: sarisia/actions-status-discord@v1
        with:
          # Usamos la URL completa del webhook. AsegÃºrate de que el secreto existe.
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }} 
          status: ${{ job.status }}
          
          # TÃ­tulo del Embed
          title: "ğŸš€ Despliegue de LWBuilds: ${{ job.status }}"
          
          # Contenido principal del Embed (Usuario y Enlaces)
          description: |
            **Iniciado por:** **`${{ github.actor }}`** ğŸ‘¤
            
            ---
            
            **Enlaces:**
            
            - URL de Pages: <https://smartz1.github.io/LWBuilds/>
            - Detalles del Job: <https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}>
          
          # Color dinÃ¡mico (en formato hexadecimal 0x)
          color: ${{ job.status == 'success' && '0x00FF00' || '0xFF0000' }}
          username: GitHub Pages Deployer