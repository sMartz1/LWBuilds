name: ğŸš€ Despliegue de GitHub Pages y NotificaciÃ³n a Discord

# 1. Definir los eventos que disparan este workflow
on:
  push:
    branches:
      - main # Dispara el workflow cuando se haga push a la rama 'main'

  # Permite ejecutar este workflow manualmente desde la pestaÃ±a Actions
  workflow_dispatch:

# 2. Definir los trabajos (jobs)
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    
    # Define los permisos necesarios para el despliegue de Pages
    permissions:
      contents: read
      pages: write
      id-token: write

    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}

    steps:
      - name: â¬‡ï¸ Checkout del CÃ³digo
        uses: actions/checkout@v4

      - name: ğŸ› ï¸ Configurar PÃ¡ginas de GitHub
        uses: actions/configure-pages@v5

      # Si tu sitio es estÃ¡tico (solo HTML/CSS/JS) no necesitas un paso de build.
      # Si usas Jekyll, Hugo, etc., aquÃ­ irÃ­a tu paso de build.
      # Ejemplo:
      # - name: ğŸ—ï¸ Compilar Sitio (Si usas un generador estÃ¡tico)
      #   run: npm run build # o tu comando de build

      - name: ğŸ“¦ Subir Artefacto
        uses: actions/upload-pages-artifact@v3
        with:
          # Directorio donde estÃ¡n tus archivos de sitio final (ej. `_site`, `public`, o la raÃ­z si es estÃ¡tico)
          path: '.' 

      - name: ğŸš€ Desplegar a GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

# 3. Paso de NotificaciÃ³n a Discord (Cambiando a acciÃ³n mÃ¡s robusta)
      - name: ğŸ”” Notificar a Discord sobre el Estado de la CompilaciÃ³n
        if: always() 
        # CAMBIO DE ACCIÃ“N: Usamos tsick-7/discord-webhook-action@v2
        uses: tsick-7/discord-webhook-action@v2 
        with:
          webhook-url: ${{ secrets.DISCORD_WEBHOOK_URL }} # Nota: El nombre del input cambiÃ³ a 'webhook-url'
          
          # La nueva acciÃ³n usa 'content' como texto principal, lo usaremos para un mensaje directo
          content: 'Despliegue de GitHub Pages ha finalizado.'
          
          # --- ConfiguraciÃ³n del Embed ---
          # La nueva acciÃ³n acepta un JSON de Embed directo, lo que es mucho mÃ¡s seguro
          embed: |
            [
              {
                "title": "ğŸ“¢ NOTIFICACIÃ“N DE DESPLIEGUE - ${{ job.status }}",
                "description": "**Estado:** ${{ job.status == 'success' && 'âœ… Despliegue Exitoso' || 'âŒ Despliegue Fallido' }}\n**Iniciado por:** **`${{ github.actor }}`** ğŸ‘¤",
                "url": "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}",
                "color": ${{ job.status == 'success' && '65280' || '16711680' }}, # 00FF00 en decimal es 65280, FF0000 es 16711680
                "footer": {
                  "text": "ğŸ”— URL de Pages: https://smartz1.github.io/LWBuilds/"
                }
              }
            ]
          
          username: GitHub Pages Deployer
          avatar-url: https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png # Nota: el input cambiÃ³ a 'avatar-url'